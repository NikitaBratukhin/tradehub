{% extends 'app/base.html' %}

{% block title %}–°–æ–∑–¥–∞—Ç—å –ø—É–±–ª–∏–∫–∞—Ü–∏—é - TradeHub{% endblock %}

{% block content %}
<div class="container">
    <div class="create-publication-container">
        <div class="page-header">
            <h1 class="page-title">–°–æ–∑–¥–∞—Ç—å —Ç–æ—Ä–≥–æ–≤—É—é –∏–¥–µ—é</h1>
            <p class="page-subtitle">–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å–≤–æ–∏–º –∞–Ω–∞–ª–∏–∑–æ–º –∏ —Ç–æ—Ä–≥–æ–≤—ã–º–∏ —É—Ä–æ–≤–Ω—è–º–∏ —Å —Å–æ–æ–±—â–µ—Å—Ç–≤–æ–º</p>
        </div>

        <form method="post" class="publication-form">
            {% csrf_token %}

            <div class="form-section">
                <h3 class="section-title">–û–ø–∏—Å–∞–Ω–∏–µ –∏–¥–µ–∏</h3>
                <div class="form-group">
                    <label for="{{ form.description.id_for_label }}">{{ form.description.label }}</label>
                    {{ form.description }}
                    {% if form.description.errors %}
                    <div class="form-errors">{{ form.description.errors }}</div>
                    {% endif %}
                    <div class="form-help">–û–ø–∏—à–∏—Ç–µ —Å–≤–æ–π –∞–Ω–∞–ª–∏–∑, –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –≤—Ö–æ–¥–∞ –∏ –æ–±—â—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é</div>
                </div>

                <div class="form-group">
                    <label for="{{ form.screenshot_id.id_for_label }}">{{ form.screenshot_id.label }}</label>
                    {{ form.screenshot_id }}
                    {% if form.screenshot_id.errors %}
                    <div class="form-errors">{{ form.screenshot_id.errors }}</div>
                    {% endif %}
                    <div class="form-help">–£–∫–∞–∂–∏—Ç–µ ID —Å–∫—Ä–∏–Ω—à–æ—Ç–∞ –∏–∑ Telegram –∏–ª–∏ URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</div>
                </div>
            </div>

            <div class="form-section">
                <h3 class="section-title">–¢–æ—Ä–≥–æ–≤—ã–µ —É—Ä–æ–≤–Ω–∏</h3>
                <div class="levels-grid">
                    <div class="form-group">
                        <label for="{{ form.target_1.id_for_label }}">{{ form.target_1.label }} <span class="required">*</span></label>
                        {{ form.target_1 }}
                        {% if form.target_1.errors %}
                        <div class="form-errors">{{ form.target_1.errors }}</div>
                        {% endif %}
                    </div>

                    <div class="form-group">
                        <label for="{{ form.target_2.id_for_label }}">{{ form.target_2.label }}</label>
                        {{ form.target_2 }}
                    </div>

                    <div class="form-group">
                        <label for="{{ form.target_3.id_for_label }}">{{ form.target_3.label }}</label>
                        {{ form.target_3 }}
                    </div>

                    <div class="form-group">
                        <label for="{{ form.stop_loss.id_for_label }}">{{ form.stop_loss.label }} <span class="required">*</span></label>
                        {{ form.stop_loss }}
                        {% if form.stop_loss.errors %}
                        <div class="form-errors">{{ form.stop_loss.errors }}</div>
                        {% endif %}
                    </div>
                </div>
                <div class="form-help">–£–∫–∞–∂–∏—Ç–µ –º–∏–Ω–∏–º—É–º –æ–¥–Ω—É —Ü–µ–ª—å –∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å—Ç–æ–ø-–ª–æ—Å—Å</div>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-primary btn-lg">
                    <span class="btn-icon">‚úçÔ∏è</span>
                    –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –∏–¥–µ—é
                </button>
                <a href="{% url 'publications' %}" class="btn btn-secondary btn-lg">–û—Ç–º–µ–Ω–∞</a>
            </div>
        </form>

        <!-- –ü—Ä–µ–≤—å—é –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ -->
        <div class="publication-preview">
            <h3 class="preview-title">–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä</h3>
            <div class="publication-card preview-card">
                <div class="publication-header">
                    <div class="author-info">
                        <div class="author-avatar">{{ user.username|first|upper }}</div>
                        <div class="author-details">
                            <div class="author-name">@{{ user.username }}</div>
                            <div class="publication-date">–°–µ–π—á–∞—Å</div>
                        </div>
                    </div>
                    <div class="publication-rating">
                        <span class="stars">‚≠ê 0.0</span>
                    </div>
                </div>

                <div class="publication-content">
                    <p class="publication-description" id="preview-description">–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ...</p>

                    <div class="trading-levels">
                        <div class="levels-header">
                            <h4>–¢–æ—Ä–≥–æ–≤—ã–µ —É—Ä–æ–≤–Ω–∏</h4>
                        </div>
                        <div class="levels-grid">
                            <div class="level target">
                                <span class="level-label">üéØ –¶–µ–ª—å 1</span>
                                <span class="level-value" id="preview-target1">‚Äî</span>
                            </div>
                            <div class="level target" id="preview-target2-container" style="display: none;">
                                <span class="level-label">üéØ –¶–µ–ª—å 2</span>
                                <span class="level-value" id="preview-target2">‚Äî</span>
                            </div>
                            <div class="level target" id="preview-target3-container" style="display: none;">
                                <span class="level-label">üéØ –¶–µ–ª—å 3</span>
                                <span class="level-value" id="preview-target3">‚Äî</span>
                            </div>
                            <div class="level stop-loss">
                                <span class="level-label">‚ùå –°—Ç–æ–ø-–ª–æ—Å—Å</span>
                                <span class="level-value" id="preview-stop">‚Äî</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="publication-footer">
                    <div class="publication-actions">
                        <button class="action-btn boost-btn" disabled>
                            <span class="boost-icon">üöÄ</span>
                            <span class="boost-count">0</span>
                            <span class="action-label">–ë—É—Å—Ç</span>
                        </button>
                        <button class="action-btn comment-btn" disabled>
                            <span class="comment-icon">üí¨</span>
                            <span class="comment-count">0</span>
                            <span class="action-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–≤—å—é –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
document.addEventListener('DOMContentLoaded', function() {
    const form = document.querySelector('.publication-form');
    const previewDescription = document.getElementById('preview-description');
    const previewTarget1 = document.getElementById('preview-target1');
    const previewTarget2 = document.getElementById('preview-target2');
    const previewTarget3 = document.getElementById('preview-target3');
    const previewStop = document.getElementById('preview-stop');
    const previewTarget2Container = document.getElementById('preview-target2-container');
    const previewTarget3Container = document.getElementById('preview-target3-container');

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è
    form.description.addEventListener('input', function() {
        previewDescription.textContent = this.value || '–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ...';
    });

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–π
    form.target_1.addEventListener('input', function() {
        previewTarget1.textContent = this.value || '‚Äî';
    });

    form.target_2.addEventListener('input', function() {
        if (this.value) {
            previewTarget2.textContent = this.value;
            previewTarget2Container.style.display = 'flex';
        } else {
            previewTarget2Container.style.display = 'none';
        }
    });

    form.target_3.addEventListener('input', function() {
        if (this.value) {
            previewTarget3.textContent = this.value;
            previewTarget3Container.style.display = 'flex';
        } else {
            previewTarget3Container.style.display = 'none';
        }
    });

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–ø-–ª–æ—Å—Å–∞
    form.stop_loss.addEventListener('input', function() {
        previewStop.textContent = this.value || '‚Äî';
    });
});
</script>
{% endblock %}